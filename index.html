<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ã”n táº­p HSG & TS10 ChuyÃªn Tin</title>
    <script>window.MathJax = { tex: { inlineMath: [['$', '$']] } };</script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/cpp.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Tinh chá»‰nh Ä‘á»ƒ Code hiá»ƒn thá»‹ Ä‘áº¹p hÆ¡n vá»›i Highlight.js */
        pre code.hljs {
            padding: 1.5em;
            border-radius: 8px;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 15px;
            line-height: 1.6;
        }
    </style>
</head>
<body>

    <header id="main-header">
        <button class="toggle-btn" onclick="toggleSidebar()">â˜° <span>MENU</span></button>
        <h1 class="header-title">HÆ¯á»šNG DáºªN VÃ€ MÃ” PHá»NG Äá»€ THI Há»ŒC SINH GIá»I TIN Há»ŒC THCS</h1>
    </header>

    <div class="wrapper">
        <nav id="sidebar">
            <div class="menu-category" onclick="toggleSubmenu('sub1')">1. TP Há»“ ChÃ­ Minh <span>â–¾</span></div>
            <div id="sub1" class="submenu">
                <div class="menu-item" onclick="toggleSubmenu('hcm0910')">NÄƒm há»c 2009 - 2010 <span style="float: right;">â–¾</span></div>
                <div id="hcm0910" class="submenu hidden" style="background: #1e293b;">
                    <a href="#" class="menu-item" onclick="loadLesson('hcm0910_nhiphan')">BÃ i 1: Nhá»‹ phÃ¢n</a>
                    <a href="#" class="menu-item" onclick="loadLesson('hcm0910_tong')">BÃ i 2: Tá»•ng</a>
                    <a href="#" class="menu-item" onclick="loadLesson('hcm0910_lamvuon')">BÃ i 3: LÃ m vÆ°á»n</a>
                </div>
                <div class="menu-item" onclick="toggleSubmenu('hcm1011')">NÄƒm há»c 2010 - 2011 <span style="float: right;">â–¾</span></div>
                <div id="hcm1011" class="submenu hidden" style="background: #1e293b;">
                    <a href="#" class="menu-item" onclick="loadLesson('hcm1011_sodu')">BÃ i 1: Sá»‘ dÆ°</a>
                    <a href="#" class="menu-item" onclick="loadLesson('hcm1011_hammobius')">BÃ i 2: HÃ m Mobius</a>
                    <a href="#" class="menu-item" onclick="loadLesson('hcm1011_biendoi')">BÃ i 3: Biáº¿n Ä‘á»•i</a>
                </div>
            </div>

        </nav>

        <main id="main-content">
            <div id="render-content">
                <div class="step-card border-blue">
                    <h2 style="text-align: center;">ChÃ o má»«ng báº¡n Ä‘áº¿n vá»›i há»‡ thá»‘ng hÆ°á»›ng dáº«n mÃ´ phá»ng giáº£i Ä‘á» thi há»c sinh giá»i tin há»c THCS</h2>
                    <p style="text-align: center;">Vui lÃ²ng chá»n má»™t chuyÃªn Ä‘á» á»Ÿ Menu bÃªn trÃ¡i Ä‘á»ƒ báº¯t Ä‘áº§u.</p>
                </div>
            </div>
            <footer class="teacher-footer">
                <div class="footer-title">Tháº§y HoÃ ng ÄÄƒng Quang - Luyá»‡n thi ChuyÃªn Tin 10</div>
                <div class="footer-info">
                    <span class="footer-item">ğŸ“ 0903781593</span>
                    <a href="http://luyenthichuyentin10.edu.vn" target="_blank" class="footer-item">ğŸŒ luyenthichuyentin10.edu.vn</a>
                </div>
            </footer>
        </main>
    </div>

    <script>
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
            document.getElementById('main-content').classList.toggle('expanded');
        }

        function toggleSubmenu(id) {
            document.getElementById(id).classList.toggle('hidden');
        }

        async function loadLesson(lessonId) {
            // 1. ÄÃ¡nh dáº¥u menu active
            document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));
            if(event && event.currentTarget) event.currentTarget.classList.add('active');

            const renderArea = document.getElementById('render-content');
            renderArea.innerHTML = "<p>Äang táº£i ná»™i dung...</p>";

            try {
                // Táº£i file markdown (ThÃªm cache breaker Ä‘á»ƒ trÃ¡nh lá»—i khÃ´ng Ä‘á»•i ná»™i dung)
                const response = await fetch(`lessons/${lessonId}.md?v=${new Date().getTime()}`);
                if (!response.ok) throw new Error("KhÃ´ng tÃ¬m tháº¥y file bÃ i há»c .md");
                
                const markdown = await response.text();

                // 2. Render Markdown trÆ°á»›c
                if (typeof marked !== 'undefined') {
                    renderArea.innerHTML = marked.parse(markdown);
                    
                    // Highlight code
                    renderArea.querySelectorAll('pre code').forEach((el) => {
                        hljs.highlightElement(el);
                    });

                    // MathJax
                    if (window.MathJax) MathJax.typesetPromise();
                }

                // 3. Táº¡o vÃ¹ng chá»©a mÃ´ phá»ng NGAY Láº¬P Tá»¨C sau ná»™i dung Markdown
                const simContainer = document.createElement('div');
                simContainer.id = 'simulation-area';
                renderArea.appendChild(simContainer);

                // 4. Xá»­ lÃ½ Script mÃ´ phá»ng
                const oldScript = document.getElementById('dynamic-sim-script');
                if (oldScript) oldScript.remove();

                const script = document.createElement('script');
                script.id = 'dynamic-sim-script';
                script.src = `simulations/${lessonId}.js?v=${new Date().getTime()}`;
                
                script.onload = () => {
                    // Gá»i trá»±c tiáº¿p tÃªn hÃ m theo lessonId mÃ  khÃ´ng cáº§n biáº¿n Ä‘á»•i gÃ¬ thÃªm
                    const initFuncName = `init_${lessonId}_simulation`; 
                    
                    if (typeof window[initFuncName] === 'function') {
                        window[initFuncName]();
                    } else {
                        console.error(`KhÃ´ng tÃ¬m tháº¥y hÃ m khá»Ÿi táº¡o: ${initFuncName}`);
                    }
                };

                document.body.appendChild(script);
                window.scrollTo(0, 0);

            } catch (error) {
                renderArea.innerHTML = `<div class="step-card border-red">
                    <h2 style="color:red">Lá»—i táº£i bÃ i há»c</h2>
                    <p>${error.message}</p>
                </div>`;
            }
        }
    </script>
</body>
</html>